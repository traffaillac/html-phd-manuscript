<!doctype html>
<!-- Rappels :
	_ N√©cessite l'installation de NodeJS ainsi que le package pagedjs-cli (brew install node && npm i -g pagedjs-cli@0.0.4 && npm i pagedjs-cli@0.0.4)
	_ Alt-3 et Alt-Shift-3 pour les guillemets apostrophes ouvrants/fermants
	_ Alt-7 et Alt-Shift-7 pour les guillemets chevrons ouvrants/fermants
	_ Alt-Dash pour le Em dash (long) et Alt-Shift-Dash pour le En dash (moyen)
	_ Alt-Space pour l'espace ins√©cable (&nbsp;)
	_ √âviter l'utilisation de <sup> et <sub> qui augmentent l'espacement interlignes (pr√©f√©rer Unicode ¬≤·µâ)
	_ Couleurs: #FF9300 (orange), #0096FF (bleu), #FF2600 (rouge), #008F00 (vert), #9437FF (violet)
-->
<html lang=fr>
<head>
	<meta charset=utf8>
	<title>Th√®se Thibault Raffaillac</title>
	<link rel=stylesheet href=style.css>
	<link rel=stylesheet href=prism.css>
	<style>
		@media print {
			@page {
				size: A4;
				margin: 3.5cm 2.5cm;
				@bottom { font: 10pt Avenir Next; content: counter(page) }
			}
			@page :left {
				@top-left {
					border-bottom: 1pt solid black;
					content: string(chapter);
					font: italic 10pt Avenir Next;
					margin-bottom: .5cm;
					vertical-align: bottom;
				}
			}
			@page :right {
				@top-right {
					border-bottom: 1pt solid black;
					content: string(section);
					font: italic 10pt Avenir Next;
					margin-bottom: .5cm;
					vertical-align: bottom;
				}
			}
			
			@page :blank {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(1) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(3) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(5) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(6) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(7) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(9) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(10) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(11) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			@page :nth(12) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
				@bottom { content: none }
			}
			
			@page :nth(13) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
			}
			@page :nth(17) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
			}
			@page :nth(65) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
			}
			@page :nth(103) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
			}
			@page :nth(165) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
			}
			@page :nth(177) {
				@top-left { border: none; content: none }
				@top-right { border: none; content: none }
			}
		}
		
		.toc {
			font: 10pt Avenir Next;
			line-height: 1.5;
			list-style: none;
			margin: 0;
			overflow-x: hidden;
			padding: 0;
			width: 16cm;
		}
		.toc li:before {
			content: ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .";
			float: left;
			white-space: nowrap;
			width: 0;
		}
		.toc a {
			color: black;
		}
		.toc a:first-child {
			background: white;
			padding-right: 0.33em;
		}
		.toc a::after {
			background: white;
			content: target-counter(attr(href), page);
			float: right;
			padding-left: 0.33em;
		}
	</style>
<body>
	<div style="margin-bottom:2cm; overflow:auto; text-align:center">
		<img src=figures/ULille.png style="float:left; height:1.5cm">
		<img src=figures/cristal.svg style="height:1.5cm">
		<img src=figures/inria.svg style="float:right; height:1.5cm">
	</div>
	<div style="font:small-caps 10pt Avenir Next; margin-bottom:1.8cm; text-align:center">
		<span style="font:small-caps 28pt Avenir Next">Th√®se</span><br>
		de<br>
		<span style="font:small-caps 23pt Avenir Next">Doctorat en Informatique</span><br>
		√âcole Doctorale SPI<br>
		UMR 9189 - CRIStAL<br>
		pr√©sent√©e et soutenue le 18/12/2019<br>
		par<br>
		<span style="font:small-caps 28pt Avenir Next">Thibault Raffaillac</span><br>
	</div>
	<div style="border-top:2px solid black; border-bottom:2px solid black; clear:both; font:small-caps 600 25pt Avenir Next; margin-bottom:2.2cm; padding:.5cm 0; text-align:center">Am√©liorer les langages et<br>biblioth√®ques logicielles pour<br>programmer l'interaction</div>
	<div style="font:small-caps 10pt Avenir Next; margin-bottom:.5em; text-align:center">devant un jury compos√© de</div>
	<div style="font:small-caps 10pt Avenir Next; overflow:auto; text-align:left">
		<div style="float:left; width:21%">Pr√©sidente<br>Rapporteurs<br><br>Examinateurs<br><br>Directeur de th√®se</div>
		<div style="float:left; font-weight:600; width:29%">
			Mme. Laurence Duchien<br>
			Mme. Sophie Dupuy-Chessa<br>
			M. √âric Lecolinet<br>
			M. St√©phane Conversy<br>
			M. Emmanuel Pietriga<br>
			M. St√©phane Huot</div>
		<div style="float:left; width:50%">
			Professeure, Universit√© de Lille<br>
			Professeure, Universit√© Grenoble Alpes<br>
			Ma√Ætre de conf√©rences (HDR), T√©l√©com ParisTech<br>
			Professeur, √âcole Nationale de l'Aviation Civile<br>
			Directeur de recherche, Inria Saclay<br>
			Directeur de recherche, Inria Lille</div>
	</div>
	
	<p class=break-right style="margin-top:10cm; text-align:right"><i>√Ä la m√©moire de Janet,<br>√† sa bienveillance,<br>et son amour des lettres</i></p>
	
	<h1 class=break-right id=remerciements>Remerciements</h1>
	<!--
		(Les remerciements doivent aider √† comprendre pourquoi j'ai explor√© cette direction.)
		Derri√®re ce travail, il y a la frustration du jeune gar√ßon il y a 20 ans qui voulait cr√©er des jeux vid√©o, mais ne r√©alisait pas l'ampleur de la t√¢che.
		Mon parcours s'est construit pour acqu√©rir l'exp√©rience et la cr√©dibilit√© de r√©aliser ses id√©es.
		les choses ne sont pas comme elles devraient √™tre
		les personnes qui ont contribu√© √† faire l'informatique y ont laiss√© une partie d'eux-m√™mes
	-->
	<!-- Remerciements (voir th√®se Fanny) : √Ä ma grand-m√®re Janet, Directeur, Parents, Audrey (√©ducation civique), tous mes profs qui ont partag√© leur passion et motiv√© √† progresser, Yoann Dufresne, Club bidouille, Lucien M, Nicolas B, les participants du club algo, L√©o, Mensa, Aur√©lien/Florian/Magda/Arnaud/Lela, Alex Maton, Alex Kohen, Flora Weissgerber, Damien Pollet (ECS), Bruno Beaufils (Paged.js), les concepteurs de Paged.js, Zapf et Frutiger (Palatino et Avenir Next), la communaut√© Open Source pour tous les logiciels que j'utilise, Hal Elrod pour le MM qui a rendu la r√©daction en fait plut√¥t agr√©able, L'√©quipe Sical pour m'avoir accueilli durant les derniers mois, D3.js, Gimp et ImageOptimizer -->
	<!-- St√©phane : patience, soutien inconditionnel, me guidait non pas l√† o√π il voulait que j'aille mais l√† o√π je voulais aller -->
	<p>
		Le document que vous avez sous les yeux est l'aboutissement de quatre ann√©es de recherches.
		Quatre ann√©es qui ont mis mes nerfs √† rude √©preuve, alternant entre apprentissages p√©nibles, p√©riodes de profonde m√©lancolie, et moments d'√©piphanie.
		Maintenant que le r√©sultat est l√†, j'esp√®re qu'il vous satisfera.
		La programmation de syst√®mes interactifs graphiques (interfaces de bureau, applications pour smartphone, jeux vid√©o) est un domaine qui m'a toujours √©t√© particuli√®rement opaque, et c'est cette frustration qui m'a pouss√© √† creuser jusqu'√† une th√®se.
		Ainsi j'ai voulu rendre ce manuscrit aussi utile que possible, en essayant de clarifier tout ce que j'avais appris sur le domaine, et en donnant parfois mon avis sur ce qu'on pourrait y apporter.
	</p>
	<p>
		Ce travail n'aurait certainement pas abouti sans l'aide et le soutien de nombreuses personnes, que j'aimerais prendre le temps de mentionner.
		Je tiens tout d'abord √† remercier mon directeur de th√®se, St√©phane Huot, qui a fait preuve d'une grande patience √† mon √©gard.
		Quand je doutais de tout, remettais en question ses conseils, et n'en faisais qu'√† ma t√™te, il a √©t√© un soutien inconditionnel et a gard√© une grande √©coute.
		J'ai beaucoup appr√©ci√© nos discussions, o√π il voyait souvent ‚Äúplus loin‚Äù et apportait des remarques cl√©s qui allaient faire avancer mon travail.
		Les innovations de cette th√®se ont ainsi √©t√© v√©ritablement co-construites, √† force d'it√©rations et √©changes fructueux.
		Je remercie St√©phane de m'avoir guid√© l√† o√π je voulais aller, plut√¥t que l√† o√π il l'avait voulu.
	</p>
	<p>
		Je tiens ensuite √† remercier mes rapporteurs, Sophie Dupuy-Chessa et √âric Lecolinet, d'avoir pris le temps de relire mon manuscrit, et tous les membres du jury (incluant St√©phane Conversy, Laurence Duchien et Emmanuel Pietriga) d'avoir accept√© d'√©valuer mon travail.
		Je suis honor√© d'avoir pu recueillir les remarques et conseils de ceux que je consid√®re comme les meilleurs experts fran√ßais sur mon sujet de th√®se¬†!
	</p>
	<p>
		Les quatre ann√©es dans l'√©quipe Loki (ex-Mjolnir) ont √©t√© particuli√®rement plaisantes, gr√¢ce √† la bienveillance de tous les membres (pass√©s et pr√©sents).
		Merci √† mes docteurs a√Æn√©s, Jonathan, Alix, Justin, Amira et Hakim, pour leur sagesse et leurs conseils (administratifs, mais pas que).
		Merci √† S√©bastien et Izzat, entre autres comme co√©quipiers lors du Hash Code 2016.
		Merci √† Nicole, Axel, Marc, Damien, Raiza, Philippe, Gr√©goire, Gabriel et Pierrick, d'avoir fait du Starter <i>the place to be</i>, pour r√¢ler, manger, jouer, ou encore travailler.
		Merci √† Julien ü§ò de m'avoir accueilli dans son clan, et pour un festival m√©morable.
		Merci √† tous les permanents de l'√©quipe, Thomas ü§ò, Sylvain, Mathieu, Nicolas, Ed, Marcello, Fanny, G√©ry, d'avoir √©t√© super accessibles, et de m'avoir tous soutenu quand vous en avez eu l'occasion.
		C'est peut-√™tre insignifiant pour vous, mais chaque coup de pouce a √©t√© une immense aide √† mon niveau.
		Et merci aux assistantes d'√©quipe, Karine et Julie, toujours souriantes quand j'arrivais avec les demandes les plus incongrues.
	</p>
	<p>
		Durant les deux premi√®res ann√©es de la th√®se je partageais mon temps avec une seconde √©quipe, RMoD, et je tiens √† en remercier tous les membres qui m'ont soutenu dans mon travail en interaction avec le domaine du G√©nie Logiciel.
		Merci √† Damien de m'avoir fait d√©couvrir ECS, et d'avoir nourri de nombreuses discussions autour de mod√®les √† objets originaux.
		Merci √† Cl√©ment, Vincent et Brice, de m'avoir aid√© √† rel√¢cher la pression avec les afterworks.
		Merci √† Olivier, Marcus, Anne, Christophe et Santiago pour votre gentillesse tout au long de mon s√©jour dans l'√©quipe, c'√©tait salutaire.
		Merci √† St√©phane pour les critiques pertinentes sur ECS, qui m'ont incit√© √† b√©tonner sa d√©fense par rapport au mod√®le objet.
	</p>
	<p>
		Pendant toute la dur√©e de ma th√®se j'avoue avoir eu un go√ªt immod√©r√© pour les projets secondaires, au d√©sespoir de mon directeur de th√®se.
		Ces projets m'ont pourtant beaucoup apport√© humainement et professionnellement, et je remercie les personnes qui y ont particip√©.
		Merci en premier lieu √† Yoann Dufresne, Yann Secq et Sophie Tison, qui ont form√© le noyau de promotion des concours d'algorithmique √† l'universit√©, gr√¢ce auxquels on a organis√© des ateliers d'entra√Ænement hebdomadaires pendant presque trois ans, et qui m'ont soutenu ensuite pour assurer des fonctions d'enseignement.
		Merci √† Lucien Mousin pour sa formidable plateforme de code en ligne qui nous a permis de dynamiser les TDs d'algorithmique (et les ateliers d'entra√Ænement).
		Merci √† Benjamin Torres √©galement dans l'organisation du hub du concours Catalysts.
		Je tiens aussi √† remercier les membres de l'espace bidouille, communaut√© hyperactive qui m'accueillait les samedis pour coder et paporter¬†: Yoann (√† nouveau), Matthieu Falce, Pierre Marijon, Pierre Pericard, Camille Lihouck et Sophie Kaleba, en particulier pour le festival Zoo Machines qui a √©t√© un sacr√© moment de cr√©ation¬†!
	</p>
	<p>
		En dehors de la th√®se j'ai pu compter sur un ami et coloc' hors pair, L√©onard ü§ò, que je remercie pour m'avoir initi√© aux festivals de musique (... Boom-lay, BOOM¬†!), fait d√©couvrir pleins de super groupes, et pour la communaut√© des M's qui m'a redonn√© confiance √† un tournant de mon travail.
		Merci √† Pierre pour les sessions Rock, et son go√ªt pour les noms d'√©quipe de blinds tests, √† d√©faut de les gagner (Emile Louise Attaque FTW).
		Merci √† Sandra et Am√©d√©e, Marie et Tupak, Charlotte et Guille, et tous ceux dont j'ai crois√© la route durant ces quatre ans √† Lille.
		Merci √† Aur√©lien, Florian, Magda, Arnaud et Lela pour les voyages dans le Grand Nord (Norv√®ge), et √† Antoine Tran, Alexandre Kohen et Flora Weissgerber pour les voyages dans le Grand Sud (Paris).
	</p>
	<p>
		√Ä plus haut niveau je tiens √† remercier tous les enseignants qui m'ont transmis leur passion de la Science tout au long des √©tudes, et m'ont souvent soutenu pour poursuivre plus loin.
		Je leur dois beaucoup, et esp√®re en faire de m√™me √† mon tour un jour.
		Merci √† Olivier Guillaumin pour les discussions tr√®s instructives sur l'avenir des langages de programmation, et pour avoir soutenu ma candidature en th√®se, alors m√™me que je d√©missionnais de son entreprise.
		Merci √©galement √† Wendy Mackay d'avoir fait le pari de me prendre en stage pr√©doctoral sans exp√©rience pr√©alable, et d'avoir soutenu ma candidature de th√®se √† Lille ensuite.
	</p>
	<p>
		Enfin je ne pouvais pas remonter dans le temps sans mentionner les outils qui ont facilit√© ma vie durant la r√©daction de ce manuscrit, et dont je suis heureux qu'ils aient exist√© √† temps pour mon travail.
		Je pense en particulier √† Paged.js (conversion HTML vers livre), qui m'a permis de r√©diger ce manuscrit int√©gralement en HTML, de g√©rer la typographie avec CSS, et de g√©n√©rer les √©l√©ments dynamiques (table des mati√®res, num√©ros de figures, liens des r√©f√©rences, etc.) avec JavaScript.
		Merci √† Zapf et Frutiger pour leurs travaux sur les polices Palatino et Avenir.
		Et un grand merci √† Hal Elrod pour sa m√©thode <i>Miracle Morning</i> qui a rendu la p√©riode de r√©dation particuli√®rement agr√©able et productive.
	</p>
	<p>
		Pour finir, je tiens √† remercier mes parents pour avoir √©t√© l'ilot de stabilit√© auquel je pouvais toujours me raccrocher quand les choses n'allaient pas.
		Et je remercie tout sp√©cialement Audrey, qui a illumin√© mon existence depuis notre rencontre, et a fait preuve d'une grande lucidit√© lorsqu'il fallait d√©m√™ler des situations inextricables.
		Avec elle j'ai appris √† d√©sirer une vie simple, avec bienveillance, randonn√©es, et √©cologie.
		Pour synth√©tiser notre √©pop√©e je terminerai sur la r√©plique finale de <i>Fight Club</i>¬†: ¬´¬†<i>You met me at a very strange time in my life.</i>¬†¬ª
	</p>
	
	<h1 class=break-right id=resume>R√©sum√©</h1>
	<p>
		L'objectif de cette th√®se est d'√©tudier et d√©velopper des mod√®les de programmation de syst√®mes interactifs, pour favoriser le prototypage et le d√©veloppement de nouvelles techniques d'interaction.
		Dans ce contexte, les d√©veloppeurs utilisent principalement des frameworks g√©n√©riques d'interfaces graphiques, qu'ils ‚Äúbricolent‚Äù pour int√©grer de nouvelles id√©es.
		Or ces frameworks sont peu adapt√©s √† de tels usages, et restreignent la libert√© des d√©veloppeurs √† d√©vier des standards √©tablis.
		Une premi√®re √©tude bas√©e sur des interviews rel√®ve les probl√®mes, besoins, utilitaires, et techniques de ‚Äúbricolage‚Äù rencontr√©s dans ce contexte.
		Une seconde √©tude bas√©e sur un questionnaire en ligne √©value la pr√©valence des probl√®mes et techniques relev√©es dans la premi√®re √©tude, ainsi que les raisons pour lesquelles les frameworks issus de la recherche sont peu utilis√©s pour concevoir de nouvelles techniques d'interaction.
		Les r√©sultats de ces √©tudes aboutissent √† la d√©finition de trois Essentiels d'Interaction, des recommandations pratiques destin√©es √† am√©liorer le support de l'interaction dans les frameworks et langages de programmation : (i) une orchestration explicite et flexible des comportements interactifs, (ii) un environnement d'interaction minimal et initialis√© au d√©marrage de toute application, et (iii) des m√©canismes et conventions standardis√©s et appuy√©s par un langage flexible.
		Ces recommandations sont illustr√©es une premi√®re fois par une extension au langage Smalltalk, qui permet d'exprimer des animations en ajoutant une dur√©e aux appels de fonctions.
		L'application des Essentiels d'Interaction est illustr√©e une seconde fois par la cr√©ation du framework Polyphony, qui se base sur le mod√®le Entit√©-Composant-Syst√®me issu du Jeu Vid√©o, et l'adapte pour la cr√©ation d'interfaces graphiques et de techniques d'interaction.
	</p>
	
	<!--
The aim of this thesis is to study and develop new ways of programming graphical interfaces in a research context.
In practice, developers mainly use generic software libraries that are not well adapted to their needs, and that they ‚Äúhack‚Äù to integrate new ideas.
A first series of interviews and an online questionnaire allow us to identify the needs of programmers in this context.
We deduce a set of recommendations, the Interaction Essentials, to guide the design of new languages and libraries.
We then propose a first extension to the Smalltalk programming language, which facilitates the expression of animations.
Finally, we present a new software library, Polyphony, designed to facilitate the creation of flexible and extensible graphical interfaces.
	-->
	<h1 class=break id=abstract>Abstract</h1>
	<p>
		The aim of this thesis is to study and develop programming models for interactive systems, to promote the prototyping and development of new interaction techniques.
		In this context, developers mainly use generic interaction frameworks, which they ‚Äúhack‚Äù to integrate new ideas.
		However, these frameworks are poorly adapted to such uses, and restrict the freedom of developers to deviate from established standards.
		A first study based on interviews identifies the problems, needs, utilities, and ‚Äúhacking‚Äù techniques encountered in this context.
		A second study based on an online questionnaire assesses the prevalence of the problems and techniques identified in the first study, as well as the reasons why research frameworks are rarely used to develop new interaction techniques.
		The results of these studies lead to the definition of three Interaction Essentials, practical recommendations to improve the support of interaction in frameworks and programming languages: (i) an explicit and flexible orchestration of interactive behaviours, (ii) a minimal and initialized interaction environment at the start of any application, and (iii) standardized mechanisms and conventions supported by a flexible language.
		These recommendations are illustrated initially by an extension to the Smalltalk language, which allows animations to be expressed by adding a duration to function calls.
		The application of the Interaction Essentials is illustrated once more with the creation of the Polyphony framework, which is based on the Entity-Component-System model originating from Video Games, and adapted for the creation of graphical user interfaces and interaction techniques.
	</p>
	
	<h1 class=break id=table_matieres>Table des mati√®res</h1>
	<div id=toc_tail></div>
	
	<script>
		var req = new XMLHttpRequest();
		function include(file) {
			req.open('GET', file, false);
			req.send();
			document.write(req.responseText);
		}
	</script>
	<script>include('introduction.html')</script>
	<script>include('1.1-contexte.html')</script>
	<script>include('1.2-problematique.html')</script>
	<script>include('1.3-eda.html')</script>
	<script>include('1.4-interviews.html')</script>
	<script>include('1.5-questionnaire.html')</script>
	<script>include('1.6-discussions.html')</script>
	<script>include('2.1-eda.html')</script>
	<script>include('2.2-orchestration.html')</script>
	<script>include('2.3-environnement.html')</script>
	<script>include('2.4-animation.html')</script>
	<script>include('3.1-eda.html')</script>
	<script>include('3.2-application.html')</script>
	<script>include('3.3-architecture.html')</script>
	<script>include('3.4-implementation.html')</script>
	<script>include('3.5-conclusion.html')</script>
	<script>include('conclusion.html')</script>
	<script>include('bibliographie.html')</script>
	<script>include('annexes.html')</script>
	
	<!-- Post-traitements -->
	<script src=prism.js></script>
	<script>
		// G√©n√©ration de la table des mati√®res
		for (let h of document.querySelectorAll('h1[id^="sec"],h2[id^="sec"],h3[id^="sec"]')) {
			let lvl = parseInt(h.tagName.substring(1)) - 1
			toc_tail.insertAdjacentHTML('beforebegin', `<ul class=toc><li><a href=#${h.id} style="padding-left:${lvl*1.5}em">${h.textContent}</a></li></ul>`)
		}
		// fill_toc(toc1, 'h2[id^="sec1"],h3[id^="sec1"]')
		// fill_toc(toc2, 'h2[id^="sec2"],h3[id^="sec2"]')
		// fill_toc(toc3, 'h2[id^="sec3"],h3[id^="sec3"]')
		
		// V√©rification de la validit√© des liens internes
		for (let a of document.getElementsByTagName('a')) {
			let href = a.getAttribute('href')
			if (href.startsWith('#')) {
				let ids = document.querySelectorAll(CSS.escape(href).substring(1))
				if (ids.length !== 1)
					console.log(`Unknown or duplicate id: ${href}`)
				else
					ids[0].setAttribute('refcount', (ids[0].getAttribute('refcount') || 0) + 1)
			} else if (!href.startsWith('http')) {
				console.log(`Broken link: ${href}`)
			}
		}
		for (let id of document.querySelectorAll('[id]:not([refcount])')) {
			console.log(`Orphan id: ${id.getAttribute('id')}`)
		}
		
		// Conversion de la bibliographie en liens externes
		for (let tr of biblio.children[0].children) {
			let s = tr.children[1].textContent
			let i = s.indexOf('http'), j = i
			if (i === -1) {
				console.log(`Reference without URL: ${tr.id}`)
				s = `https://www.qwant.com/?q=${encodeURIComponent(s)}`
			} else {
				while (j < s.length && "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~:/?#[]@!$&'()*+,;=".includes(s[j]))
					j++
				s = s.slice(i, j)
			}
			for (let a of document.querySelectorAll(`a[href="#${CSS.escape(tr.id)}"]`))
				a.setAttribute('href', s)
		}
	</script>
</body>
</html>
